//This file is automatically generated by MotionPRO Suite
//DO NOT MODIFY THIS FILE; your changes will be overwritten

// Exercise 7 - Tube Fill axis
//
  int gConveyorCtrl; // Define integer variable gConveyorCtrl

  int gTubeFeedCtrl; // Define integer variable gTubeFeedCtrl

  int gTubeFillCtrl; // Define integer variable gTubeFillCtrl

  int gMasterCtrl; // Define integer variable gMasterCtrl

// End of user variable definition
  gConveyorCtrl = 0;

  gTubeFeedCtrl = 0;

  gTubeFillCtrl = 0;

  gMasterCtrl = 0;

// End of Network user variable initialization
  int Temp; // Define integer variable Temp

// End of user variable definition
  Temp = 0;

// End of user variable initialization
MotionLoop: //Define label MotionLoop

FillTrig: //Define label FillTrig

  Temp = gTubeFillCtrl;

  SRB Temp, 0x1, 0x0; //Set Temp using AND mask 0x0001 and OR mask 0x0000

  GOTO FillTrig, Temp, EQ; //Branch to FillTrig if Temp == 0

  GOTO FillFast, gMasterCtrl, NEQ; //Branch to FillFast if gMasterCtrl != 0

FillSlow: //Define label FillSlow

  SETPT 0xCF00; //Clear PT buffer
  MODE PT; // Set PT Mode
  TUM1;//Start from actual value of position reference
  CPR;
  PTP 4000L, 1250U, 0; //PT(1[rot], 1[s])
  UPD; //Execute immediate
  PTP 16000L, 1250U, 0; //PT(5[rot],2[s])
  PTP 0L, 625U, 0; //PT(5[rot],2.5[s])
  PTP -2000L, 313U, 0; //PT(4.5[rot],2.75[s])
  !MC; WAIT!; //wait for completion

  GOTO FillComplete; //Branch to FillComplete

FillFast: //Define label FillFast

  SETPT 0xCF00; //Clear PT buffer
  MODE PT; // Set PT Mode
  TUM1;//Start from actual value of position reference
  CPR;
  PTP 4000L, 313U, 0; //PT(1[rot], 0.25[s])
  UPD; //Execute immediate
  PTP 16000L, 437U, 0; //PT(5[rot],0.6[s])
  PTP 0L, 188U, 0; //PT(5[rot],0.75[s])
  PTP -1000L, 125U, 0; //PT(4.75[rot],0.85[s])
  !MC; WAIT!; //wait for completion

  GOTO FillComplete; //Branch to FillComplete

FillComplete: //Define label FillComplete

  SRB Temp, 0x0, 0x10; //Set Temp using AND mask 0x0000 and OR mask 0x0010

  gTubeFillCtrl = Temp;

  [255]gTubeFillCtrl = Temp; //Send the local variable Temp to variable gTubeFillCtrl of axis/group 255

  GOTO MotionLoop; //Branch to MotionLoop

// End of Main program loop
// End of program
